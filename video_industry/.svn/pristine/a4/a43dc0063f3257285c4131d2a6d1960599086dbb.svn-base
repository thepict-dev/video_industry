<%@ page contentType="text/html; charset=utf-8" pageEncoding="utf-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<%@ taglib prefix="form" uri="http://www.springframework.org/tags/form"%>
<%@ taglib prefix="ui" uri="http://egovframework.gov/ctl/ui"%>
<%@ taglib prefix="spring" uri="http://www.springframework.org/tags"%>

<!DOCTYPE html>
<html lang="ko">
<c:import url="../main/header.jsp">
	<c:param name="pageTitle" value="강의등록" />
</c:import>

<body class="sb-nav-fixed">

	<form action="" id="register" name="register" method="post" enctype="multipart/form-data">
		<%@include file="../main/navigation.jsp"%>
		<div id="layoutSidenav">
			<div id="layoutSidenav_nav">
				<%@include file="../main/gnb.jsp"%>
			</div>
			<div id="layoutSidenav_content">
				<main class="contents">
					<h2 class="contents-title">수업등록</h2>
					<div class="contents-box">
						<div class="card">
							<div class="card-body">
								<div class="write-box">
									<div class="write-item">
										<label for="campus_id" class="title">캠퍼스</label>
										<div class="input-box">
											<select id="campus_id" name="campus_id" class="input opt-max-width-200">
												<option value="0">캠퍼스선택</option>
												<option value="1" <c:if test="${pictVO.campus_id eq '1'}"> selected </c:if> >춘천</option>
												<option value="2" <c:if test="${pictVO.campus_id eq '2'}"> selected </c:if> >삼척</option>
												<option value="3" <c:if test="${pictVO.campus_id eq '3'}"> selected </c:if> >도계</option>
											</select>
										</div>
									</div>
									<div class="write-item">
										<label for="name" class="title">교수명</label>
										<div class="input-box">
											<input type="text" id="name" name="name" value="${pictVO.name}" class="input opt-max-width-200" autocomplete="off">
										</div>
									</div>
									<div class="write-item">
										<label for="title" class="title">수업명*</label>
										<div class="input-box">
											<input type="text" class="input" id="title" name="title" value="${pictVO.title}" autocomplete="off">
										</div>
									</div>
									<div class="write-item type2">
										<div class="write-row" style="flex:0 0 50%;">
											<label for="zoom_no" class="title">Zoom 방번호*</label>
											<div class="input-box">
												<input type="text"class="input" id="zoom_no" name="zoom_no"value="${pictVO.zoom_no}" autocomplete="off">
												<span id="url_validation" style="float:left; margin-top:5px; margin-left:15px"></span>
											</div>
										</div>
										<div class="write-row" style="flex:0 0 20%;">
											<label for="zoom_pw" class="title">Zoom 비밀번호*</label>
											<div class="input-box">
												<input type="text"class="input" id="zoom_pw" name="zoom_pw" value="${pictVO.zoom_pw}" autocomplete="off">
											</div>
										</div>
									</div>
									<div class="write-item type2">
										<div class="write-row" style="flex:0 0 20%;">
											<label for="week" class="title">강의날짜*</label>
											<div class="input-box">
												<input type="text" class="input" id="week" name="week" value="${pictVO.week}" autocomplete="off">
											</div>
										</div>
										<div class="write-row" style="flex:0 0 20%;">
											<label for="time" class="title">강의시작시간*</label>
											<div class="input-box">
												<input type="text" placeholder="14:00" class="input" id="time" name="time" value="${pictVO.time}" autocomplete="off">
											</div>
										</div>
									</div>
									<c:if test="${pictVO.saveType ne 'insert'}">
										<div class="write-item">
											<label for="title" class="title">활성여부*</label>
											<div class="input-box">
													
												<c:if test="${pictVO.use_at eq 'N'}">
													<button type="button" class="state-box state-n" onclick="javascript:cng_use_at('${pictVO.idx}', '${pictVO.use_at}');">
									            		<span class="text">비활성화</span> 
									            	</button>
												</c:if> 
												<c:if test="${pictVO.use_at ne 'N'}">
													<button type="button" class="state-box state-y" onclick="javascript:cng_use_at('${pictVO.idx}', '${pictVO.use_at}');">
									            		<span class="text">활성화</span> 
									            	</button>
												</c:if>
											</div>
										</div>
									</c:if>
								</div>
								<div class="btn-box">
									<button type="button" onclick="button1_click();" class="btn-basic btn-primary btn-sm">
										<c:if test="${pictVO.saveType eq 'insert'}">등록</c:if>
										<c:if test="${pictVO.saveType ne 'insert'}">수정</c:if>
									</button>
					        		<button type="button" onclick="javascript:lecture_list()" class="btn-basic btn-common btn-sm">목록보기</button>
								</div>
							</div>
						</div>
					</div>
				</main>
				<%@include file="../main/footer.jsp"%>
			</div>
		</div>
		<input type='hidden' name="saveType" id="saveType"
			value='${pictVO.saveType}' /> <input type='hidden' name="idx"
			id="idx" value='${pictVO.idx}' /> <input type='hidden' name="use_at"
			id="use_at" value='${pictVO.use_at}' />
	</form>

	<script>
		function lecture_list() {
			location.href = "/lecture/lecture_list.do";
		}

		

		function cng_use_at(idx, use_at) {
			var text = "활성화 상태로 변경하시겠습니까?";
			if (use_at == "Y") {
				text = "비활성화 상태로 변경하시겠습니까?";
			}

			if (confirm(text)) {
				$("#register").attr("action", "/lecture/cng_use_at.do");
				$("#register").submit();
			}

		}

		$('#link_url').focusout(function(){
			var pattern = new RegExp('^(https?:\\/\\/)?'+ // protocol
				    '((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|'+ // domain name
				    '((\\d{1,3}\\.){3}\\d{1,3}))'+ // OR ip (v4) address
				    '(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*'+ // port and path
				    '(\\?[;&a-z\\d%_.~+=-]*)?'+ // query string
				    '(\\#[-a-z\\d_]*)?$','i'); // fragment locator
			var url = $('#link_url').val()
			
			//url_validation
			if(pattern.test(url)){
				//url이 올바를때
				$("#url_validation").text("유효한 링크입니다.").css("color", "blue");
			}
			else{
				//올바르지 않을때
				$("#url_validation").text("유효하지 않은 링크입니다.").css("color", "red");
				
			}
		})
		function button1_click() {
			var name = $('#name').val();
			var title = $('#title').val();
			var zoom_no = $('#zoom_no').val();
			var zoom_pw = $('#zoom_pw').val();
			var depart = $('#depart').val();
			
			var week = $('#week').val();
			var saveType = $('#saveType').val();
			
			var pattern = new RegExp('^(https?:\\/\\/)?'+ // protocol
				    '((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|'+ // domain name
				    '((\\d{1,3}\\.){3}\\d{1,3}))'+ // OR ip (v4) address
				    '(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*'+ // port and path
				    '(\\?[;&a-z\\d%_.~+=-]*)?'+ // query string
				    '(\\#[-a-z\\d_]*)?$','i'); // fragment locator
			
			
			
		    
		    if (name == "" || name == undefined) {
				window.alert("담당교수명을 입력해주세요.");
				$('#name').focus();
				return false;
			} else if (title == "" || title == undefined) {
				window.alert("수업명을 입력해주세요.");
				$('#title').focus();
				return false;
			} else if (zoom_no == "" || zoom_no == undefined) {
				window.alert("Zoom 방번호를 입력해주세요.");
				$('#zoom_no').focus();
				return false;
			}else if (zoom_pw == "" || zoom_pw == undefined) {
				window.alert("Zoom 비밀번호를 입력해주세요.");
				$('#zoom_pw').focus();
				return false;
			}else if (week == "" || week == undefined) {
				window.alert("강의날짜를 입력해주세요.");
				$('#week').focus();
				return false;
			} 
		   /*  if(!pattern.test(link_url)){
		    	window.alert("유효하지 않은 링크입니다.");
				$('#link_url').focus();
				return false;
		    } */

			var text = "등록하시겠습니까?";
			if (saveType == 'update') {
				text = "수정하시겠습니까?"
			}

			if (confirm(text)) {
				$("#register").attr("action", "/lecture/lecture_save.do");
				$("#register").submit();
			}
		}
		
		$( function() {
		    $( "#week" ).datepicker();
		  } );
		
		$.datepicker.setDefaults({
	        dateFormat: 'yy-mm-dd',
	        prevText: '이전 달',
	        nextText: '다음 달',
	        monthNames: ['1월', '2월', '3월', '4월', '5월', '6월', '7월', '8월', '9월', '10월', '11월', '12월'],
	        monthNamesShort: ['1월', '2월', '3월', '4월', '5월', '6월', '7월', '8월', '9월', '10월', '11월', '12월'],
	        dayNames: ['일', '월', '화', '수', '목', '금', '토'],
	        dayNamesShort: ['일', '월', '화', '수', '목', '금', '토'],
	        dayNamesMin: ['일', '월', '화', '수', '목', '금', '토'],
	        showMonthAfterYear: true,
	        yearSuffix: '년'
	    });
	</script>

	<script src="../../../../../js/bootstrap.bundle.min.js"
		crossorigin="anonymous"></script>
	<script src="../../../../../js/scripts.js"></script>
	<script src="../../../../../js/Chart.min.js" crossorigin="anonymous"></script>
	<script src="../../../../../js/simple-datatables@latest.js"
		crossorigin="anonymous"></script>

</body>
</html>