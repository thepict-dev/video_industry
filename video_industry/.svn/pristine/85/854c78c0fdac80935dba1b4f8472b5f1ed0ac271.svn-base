<%@ page contentType="text/html; charset=utf-8" pageEncoding="utf-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<%@ taglib prefix="form" uri="http://www.springframework.org/tags/form"%>
<%@ taglib prefix="ui" uri="http://egovframework.gov/ctl/ui"%>
<%@ taglib prefix="spring" uri="http://www.springframework.org/tags"%>

<!DOCTYPE html>
<html lang="ko">
<c:import url="../main/header.jsp">
	<c:param name="pageTitle" value="영상 등록" />
</c:import>
<body class="sb-nav-fixed">
	<form action="" id="register" name="register" method="post" enctype="multipart/form-data">
		<%@include file="../main/navigation.jsp"%>
		<div id="layoutSidenav">
			<div id="layoutSidenav_nav">
				<%@include file="../main/gnb.jsp"%>
			</div>
			<div id="layoutSidenav_content">
				<main class="contents">
					<h2 class="contents-title">영상 등록</h2>
					<div class="contents-box">
						<div class="card">
							<div class="card-body">
								<div class="write-box">
									<div class="write-item">
										<label for="title" class="title">영상제목</label>
										<div class="input-box">
											<input type="text" id="title" name="title" value="${pictVO.title}" class="input opt-max-width-600">
										</div>
									</div>
									<div class="write-item">
										<label for="title" class="title">캠퍼스</label>
										<div class="input-box">
											<select id="campus" name="campus" style="width:150px">
												<option value="duri" <c:if test="${pictVO.campus eq 'duri' || pictVO.campus eq ''}"> selected </c:if> >두리캠퍼스</option>
												<option value="samcheok" <c:if test="${pictVO.campus eq 'samcheok'}"> selected </c:if> >삼척캠퍼스</option>
											</select>
											
										</div>
									</div>
									<div class="write-item">
										<label for="title" class="title">영상타입</label>
										<div class="input-box">
											<select id="video_type" name="video_type" style="width:150px">
												<option value="youtube" <c:if test="${pictVO.video_type eq 'youtube' || pictVO.video_type eq ''}"> selected </c:if> >유튜브링크</option>
												<option value="local" <c:if test="${pictVO.video_type eq 'local'}"> selected </c:if> >파일업로드</option>
											</select>
											
										</div>
									</div>
									<div class="write-item" id="youtube_div">
										<label for="title" class="title">유튜브링크</label>
										<div class="input-box">
											<input type="text" id="url" name="url" value="${pictVO.url}" class="input opt-max-width-600">
										</div>
									</div>
									<div class="write-item" id="file_div">
										<label for="title" class="title">파일업로드</label>
										<div class="input-box">
											<input type="file" id="attach_file" name="attach_file" value="${pictVO.file}" class="input opt-max-width-600">
											<br>
											<span id="upload_file_span">${pictVO.file}</span>
											<a href="#lnk" onclick="file_del()">x버튼</a>	
										</div>
									</div>
									
									<c:if test="${pictVO.saveType eq 'update'}">
										<div class="write-item">
											<label for="title" class="title">활성여부*</label>
											<div class="input-box">
												<c:if test="${pictVO.use_at eq 'N'}">
									            	<button type="button" class="state-box state-n" onclick="javascript:cng_use_at('${pictVO.idx}', '${pictVO.use_at}');">
									            		<span class="text">비활성화</span> 
									            	</button>
								            	</c:if>
								            	<c:if test="${pictVO.use_at ne 'N'}">
									            	<button type="button" class="state-box state-y" onclick="javascript:cng_use_at('${pictVO.idx}', '${pictVO.use_at}');">
									            		<span class="text">활성화</span>
									            	</button>
								            	</c:if>
												
											</div>
										</div>
									</c:if>
									
								</div>
								<div class="btn-box">
									<c:if test="${pictVO.saveType eq 'update'}">
										<button type="button" onclick="javascript:video_delete()" class="btn-basic btn-fill btn-sm">삭제</button>
									</c:if>
									<c:if test="${pictVO.saveType eq 'insert'}">
										<button type="button" onclick="button1_click();" class="btn-basic btn-primary btn-sm">등록</button>
									</c:if>
									<c:if test="${pictVO.saveType ne 'insert'}">
										<button type="button" onclick="button1_click();" class="btn-basic btn-primary btn-sm">수정</button>
									</c:if>
						        	<button type="button" onclick="javascript:video_list();" class="btn-basic btn-common btn-sm">목록보기</button>    
					            </div>
							</div>
						</div>
		            </div>
				</main>
			</div>
		</div>
		<input type='hidden' name="saveType" id="saveType" value='${pictVO.saveType}' /> 
		<input type='hidden' name="idx" id="idx" value='${pictVO.idx}' /> 
		<input type='hidden' name="use_at" id="use_at" value='${pictVO.use_at}' />
		<input type='hidden' name="type" id="type" value='' />
		
	</form>
	
	<script>
		/* $('#attach_file').change(function() {
			if(this.files && this.files[0]){
				if(this.files[0].type == ''){
					$('#attach_file').val("")
					return false
				}
				$("#upload_file_span").text(this.files[0].name);
			}
			else{
				$("#upload_file_span").text("");
			}
		}) */
		$(document).ready(function (){
			if($('#video_type').val() == 'youtube'){
				$('#youtube_div').show()
				$('#file_div').hide()
			}
			if($('#video_type').val() == 'local'){
				$('#file_div').show()
				$('#youtube_div').hide()
			}
		})
	
		$('#video_type').change(function(){
			if($('#video_type').val() == 'youtube'){
				$('#youtube_div').show()
				$('#file_div').hide()
			}
			if($('#video_type').val() == 'local'){
				$('#file_div').show()
				$('#youtube_div').hide()
			}
		})
		function file_del(){
			$('#attach_file').val('')
			$("#upload_file_span").text("");
			if (confirm("첨부파일을 삭제 하시겠습니까?")) {
				$("#register").attr("action", "/video/video_file_delete.do");
				$("#register").submit();
			}
		}
		function video_delete() {
			if (confirm("삭제 하시겠습니까?")) {
				$("#register").attr("action", "/video/video_delete.do");
				$("#register").submit();
			}
			
		}
		function video_list() {
			location.href = "/video/video_list.do";
		}
		function button1_click() {
			var title = $('#title').val();
			
			var saveType = $('#saveType').val();

			if (title == "" || title == undefined) {
				window.alert("제목을 입력해주세요.");
				$('#title').focus();
				return false;
			}
			var text = "등록하시겠습니까?";
			if (saveType == 'update') {
				text = "수정하시겠습니까?"
			}

		
			if (confirm(text)) {
				$("#register").attr("action", "/video/video_save.do");
				$("#register").submit();
			}
		}
		function cng_use_at(idx, use_at){
			$('#idx').val(idx)
			$('#use_at').val(use_at)
			$('#type').val('1');
			var text = "활성화 상태로 변경하시겠습니까?";
			if(use_at == "Y"){
				$('#type').val('2');
				text = "비활성화 상태로 변경하시겠습니까?";
			}
			
			if(confirm (text)){
				$("#register").attr("action", "/video/cng_use_at.do");
				$("#register").submit();
			}
			
		}
	</script>
	<script src="../../../../../js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
	<script src="../../../../../js/scripts.js"></script>
	<script src="../../../../../js/Chart.min.js" crossorigin="anonymous"></script>
	<script src="../../../../../js/simple-datatables@latest.js" crossorigin="anonymous"></script>

</body>
</html>